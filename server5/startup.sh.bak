#!/bin/sh
#
# This script executed when system startup.

# IP binding
filepath=$0
folderpath=${filepath%/*}

$folderpath/../setip.sh eth1 10.12.17.218 10.12.17.200

# load modules
$folderpath/setmodules.sh

# virtual ip binding for load balancing
#$folderpath/../setip.sh bond0:0 10.12.17.200
$folderpath/../setip.sh eth1:0 10.12.17.200

# start pvfs2 server
pvfs2-server -a 10.12.17.214 /etc/pvfs2-fs.conf

# mount 
pvfs2fuse /mnt/storage-server1 -o fs_spec="tcp://10.12.17.214:3334/pvfs2-fs" -o allow_other
pvfs2fuse /mnt/storage-server2 -o fs_spec="tcp://10.12.17.216:3334/pvfs2-fs" -o allow_other
pvfs2fuse /mnt/storage-server3 -o fs_spec="tcp://10.12.17.218:3334/pvfs2-fs" -o allow_other
